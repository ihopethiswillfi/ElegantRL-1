import sys
import gym

from elegantrl.train.run import train_and_evaluate, train_and_evaluate_mp
from elegantrl.train.config import Arguments
from elegantrl.agents.AgentDDPG import AgentDDPG
from elegantrl.agents.AgentTD3 import AgentTD3
from elegantrl.agents.AgentSAC import AgentSAC, AgentReliableSAC


def demo_ddpg_td3_sac(gpu_id, drl_id, env_id):  # 2022.02.02
    env_name = ['Pendulum-v0',
                'Pendulum-v1',
                'LunarLanderContinuous-v2',
                'BipedalWalker-v3',
                'Hopper-v2',
                'Humanoid-v3', ][env_id]
    agent = [AgentDDPG, AgentTD3, AgentSAC, AgentReliableSAC][drl_id]

    if env_name in {'Pendulum-v0', 'Pendulum-v1'}:
        from elegantrl.envs.CustomGymEnv import PendulumEnv
        env = PendulumEnv(env_name, target_return=-500)
        """
        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        2  1.60e+03-1147.49 |-1147.49  179.2    200     0 |   -2.61   0.90   0.55   1.00
        2  5.84e+04 -121.61 | -121.61   59.0    200     0 |   -0.81   0.33 -40.64   0.79
        | UsedTime:     132 |

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        1  1.60e+03-1267.96 |-1267.96  329.7    200     0 |   -2.67   0.88   0.56   1.00
        1  8.48e+04 -171.79 | -182.24   63.3    200     0 |   -0.30   0.32 -30.75   0.64
        1  1.19e+05 -171.79 | -178.25  116.8    200     0 |   -0.31   0.16 -22.52   0.43
        1  1.34e+05 -164.56 | -164.56   99.1    200     0 |   -0.31   0.15 -18.09   0.35
        1  1.47e+05 -135.20 | -135.20   92.1    200     0 |   -0.31   0.14 -15.65   0.29
        | UsedTime:     783 | 
        """
        args = Arguments(agent, env)
        args.reward_scale = 2 ** -1  # RewardRange: -1800 < -200 < -50 < 0
        args.gamma = 0.97
        args.target_step = args.max_step * 2
        args.eval_times = 2 ** 3
    elif env_name == 'LunarLanderContinuous-v2':
        """
        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        2  4.25e+03 -143.93 | -143.93   29.6     69    12 |   -2.47   1.06   0.13   0.15
        2  1.05e+05  170.35 |  170.35   57.9    645   177 |    0.06   1.59  15.93   0.20
        2  1.59e+05  170.35 |   80.46  125.0    775   285 |    0.07   1.14  29.92   0.29
        2  1.95e+05  221.39 |  221.39   19.7    449   127 |    0.12   1.09  32.16   0.40
        | UsedTime:     421 |

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        1  4.26e+03 -139.77 | -139.77   36.7     67    12 |   -2.16  11.20   0.12   0.15
        1  1.11e+05 -105.09 | -105.09   84.3    821   244 |   -0.14  27.60   1.04   0.21
        1  2.03e+05  -15.21 |  -15.21   22.7   1000     0 |   -0.01  17.96  36.95   0.45
        1  3.87e+05   59.39 |   54.09  160.7    756   223 |    0.00  16.57  88.99   0.73
        1  4.03e+05   59.39 |   56.16  103.5    908   120 |    0.06  16.47  84.27   0.71
        1  5.10e+05  186.59 |  186.59  103.6    547   257 |   -0.02  12.72  67.97   0.57
        1  5.89e+05  226.93 |  226.93   20.0    486   154 |    0.13   9.27  68.29   0.51
        | UsedTime:    3407 |

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        1  4.15e+03 -169.01 | -169.01   87.9    110    59 |   -2.18  11.86   0.10   0.15
        1  1.09e+05  -84.47 |  -84.47   80.1    465   293 |   -0.30  30.64  -6.29   0.20
        1  4.25e+05   -8.33 |   -8.33   48.4    994    26 |    0.07  13.51  76.99   0.62
        1  4.39e+05   87.29 |   87.29   86.9    892   141 |    0.04  12.76  70.37   0.61
        1  5.57e+05  159.17 |  159.17   65.7    721   159 |    0.10  10.31  59.90   0.51
        1  5.87e+05  190.09 |  190.09   71.7    577   175 |    0.09   9.45  61.74   0.48
        1  6.20e+05  206.74 |  206.74   29.1    497   108 |    0.09   9.21  62.06   0.47
        | UsedTime:    4433 |
        """
        # env = gym.make('LunarLanderContinuous-v2')
        # get_gym_env_args(env=env, if_print=True)
        env_func = gym.make
        env_args = {'env_num': 1,
                    'env_name': 'LunarLanderContinuous-v2',
                    'max_step': 1000,
                    'state_dim': 8,
                    'action_dim': 2,
                    'if_discrete': False,
                    'target_return': 200,

                    'id': 'LunarLanderContinuous-v2'}
        args = Arguments(agent, env_func=env_func, env_args=env_args)

        args.target_step = args.max_step
        args.gamma = 0.99
        args.eval_times = 2 ** 5
    elif env_name == 'BipedalWalker-v3':
        """
        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        3  7.51e+03 -111.59 | -111.59    0.2     97     7 |   -0.18   4.23  -0.03   0.02
        3  1.48e+05 -110.19 | -110.19    1.6     84    30 |   -0.59   2.46   3.18   0.03
        3  5.02e+05  -31.84 | -102.27   54.0   1359   335 |   -0.06   0.85   2.84   0.04
        3  1.00e+06   -7.94 |   -7.94   73.2    411   276 |   -0.17   0.72   1.96   0.03
        3  1.04e+06  131.50 |  131.50  168.3    990   627 |    0.06   0.46   1.69   0.04
        3  1.11e+06  214.12 |  214.12  146.6   1029   405 |    0.09   0.50   1.63   0.04
        3  1.20e+06  308.34 |  308.34    0.7   1106    20 |    0.29   0.72   4.56   0.05
        | UsedTime:    8611 |

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        3  6.75e+03  -92.44 |  -92.44    0.2    120     3 |   -0.18   1.94  -0.00   0.02
        3  3.95e+05  -37.16 |  -37.16    9.2   1600     0 |   -0.06   1.90   4.20   0.07
        3  6.79e+05  -23.32 |  -42.54   90.0   1197   599 |   -0.02   0.91   1.57   0.04
        3  6.93e+05   46.92 |   46.92   96.9    808   395 |   -0.04   0.57   1.34   0.04
        3  8.38e+05  118.86 |  118.86  154.5    999   538 |    0.14   1.44   0.75   0.05
        3  1.00e+06  225.56 |  225.56  124.1   1207   382 |    0.13   0.72   4.75   0.06
        3  1.02e+06  283.37 |  283.37   86.3   1259   245 |    0.14   0.80   3.96   0.06
        3  1.19e+06  313.36 |  313.36    0.9   1097    20 |    0.21   0.78   6.80   0.06
        | UsedTime:    9354 | SavedDir: ./BipedalWalker-v3_ModSAC_3

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        3  6.55e+03 -109.86 | -109.86    4.5    156    30 |   -0.06   0.71  -0.01   0.02
        3  1.24e+05  -88.28 |  -88.28   26.2    475   650 |   -0.15   0.15   0.04   0.02
        3  3.01e+05  -47.89 |  -56.76   21.7   1341   540 |   -0.03   0.19  -2.76   0.05
        3  3.82e+05   80.89 |   53.79  140.1    983   596 |   -0.01   0.18   0.46   0.05
        3  4.35e+05  137.70 |   28.54  104.7    936   581 |   -0.01   0.21   0.63   0.06
        3  4.80e+05  158.71 |   25.54  114.7    524   338 |    0.18   0.17   6.17   0.06
        3  5.31e+05  205.81 |  203.27  143.9   1048   388 |    0.14   0.15   4.00   0.06
        3  6.93e+05  254.40 |  252.74  121.1    992   280 |    0.21   0.12   7.34   0.06
        3  7.11e+05  304.79 |  304.79   73.4   1015   151 |    0.21   0.12   5.69   0.06
        | UsedTime:    3215 | 

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        1  7.08e+03 -106.48 | -106.48    6.0    170    17 |   -0.14   0.70   0.03   0.02
        1  2.38e+05  -89.62 |  -89.62   29.8    775   728 |   -0.30   0.31 -13.44   0.04
        1  4.12e+05  -33.40 |  -34.50   27.6   1342   516 |   -0.01   0.20   1.34   0.06
        1  5.05e+05    2.54 |  -47.29   20.9   1342   516 |    0.02   0.17   0.24   0.05
        1  5.43e+05   52.93 |   52.93  107.6   1084   540 |   -0.21   0.15   0.32   0.05
        1  5.80e+05  138.30 |  136.60   77.6   1460   176 |    0.10   0.16   2.14   0.05
        1  6.16e+05  188.98 |  171.72   99.2   1386   305 |    0.12   0.16  -0.40   0.05
        1  7.06e+05  250.72 |  231.97  142.9   1247   448 |    0.12   0.13   2.81   0.05
        1  8.06e+05  287.28 |  -68.06    5.9    211    19 |   -0.08   0.12   7.83   0.06
        1  8.56e+05  291.10 |  286.19   56.0   1181    63 |    0.17   0.13   6.37   0.06
        1  8.83e+05  314.54 |  314.54    1.0   1252    19 |    0.11   0.12   7.23   0.06
        | UsedTime:    5008 | 
        """
        env_func = gym.make
        env_args = {'env_num': 1,
                    'env_name': 'BipedalWalker-v3',
                    'max_step': 1600,
                    'state_dim': 24,
                    'action_dim': 4,
                    'if_discrete': False,
                    'target_return': 300,

                    'id': 'BipedalWalker-v3', }
        args = Arguments(agent, env_func=env_func, env_args=env_args)
        args.target_step = args.max_step
        args.gamma = 0.98
        args.eval_times = 2 ** 4
    elif env_name == 'Hopper-v2':
        """
        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        5  1.61e+04  131.99 |  131.99    3.6     81     2 |    0.03   0.09   0.03  -0.54
        5  2.20e+05  391.44 |  391.44    0.3    158     0 |    0.08   0.01  -0.06  -0.75
        5  4.25e+05  860.96 |  860.96   11.9    280     5 |    0.09   0.11   0.12  -0.84
        5  6.27e+05 3001.43 | 3001.43    7.9   1000     0 |    0.10   0.78  -0.01  -0.85
        5  1.64e+06 3203.09 | 3103.14    0.0   1000     0 |    0.10   1.82  -0.06  -0.76
        5  2.86e+06 3256.43 | 3152.72    0.0   1000     0 |    0.10   0.75   0.01  -0.67
        5  3.88e+06 3256.43 | 1549.69    0.0    512     0 |    0.10   0.86   0.00  -0.71
        | UsedTime:    2565 |

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        2  1.60e+04  328.68 |  328.68    6.2    262     6 |    0.02   0.01  -0.02  -0.54
        2  2.16e+05 2460.57 | 2460.57   14.3   1000     0 |    0.09   0.86   0.20  -0.74
        2  6.22e+05 2789.97 | 2788.28   30.9   1000     0 |    0.10   0.40  -0.11  -1.04
        2  1.23e+06 3263.16 | 3216.96    0.0   1000     0 |    0.10   1.06   0.12  -1.05
        2  2.46e+06 3378.50 | 3364.02    0.0   1000     0 |    0.11   0.87   0.02  -0.92
        2  3.90e+06 3397.88 | 3302.80    0.0   1000     0 |    0.11   0.46   0.01  -0.93
        | UsedTime:    2557 |

        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        4  2.41e+04  222.39 |  222.39    1.5    120     1 |    0.94   8.45   0.05  -0.55
        4  5.34e+05  344.58 |  344.58    0.4    142     0 |    2.41   1.91   0.02  -0.94
        4  8.74e+05  540.69 |  540.69   20.1    180     4 |    2.96   5.82   0.00  -1.10
        4  1.39e+06  989.51 |  989.51    2.2    308     2 |    3.20  16.75   0.07  -1.08
        4  1.73e+06 3161.60 | 3149.35    0.0   1000     0 |    3.26  43.84  -0.02  -1.08
        4  2.06e+06 3367.27 | 3105.77    0.0   1000     0 |    3.32  44.14   0.00  -1.13
        4  3.92e+06 3604.42 | 3565.39    0.0   1000     0 |    3.44  30.54   0.04  -1.04
        4  5.76e+06 3717.06 | 3607.94    0.0   1000     0 |    3.40  51.92   0.07  -0.95
        4  6.26e+06 3840.95 | 3409.25    0.0   1000     0 |    3.32  66.48  -0.02  -0.94
        | UsedTime:    6251 |
        """
        env_func = gym.make
        env_args = {
            'env_num': 1,
            'env_name': 'Hopper-v2',
            'max_step': 1000,
            'state_dim': 11,
            'action_dim': 3,
            'if_discrete': False,
            'target_return': 3800.,
        }
        args = Arguments(agent, env_func=env_func, env_args=env_args)
        args.eval_times = 2 ** 2
        args.reward_scale = 2 ** -4

        args.target_step = args.max_step * 2
        args.worker_num = 2

        args.net_dim = 2 ** 8
        args.layer_num = 3
        args.batch_size = int(args.net_dim * 2)
        args.repeat_times = 2 ** 4
        args.gamma = 0.99

        args.if_allow_break = False
        args.break_step = int(8e6)
    elif env_name == 'Humanoid-v3':
        from elegantrl.envs.CustomGymEnv import HumanoidEnv
        env_func = HumanoidEnv
        env_args = {
            'env_num': 1,
            'env_name': 'Humanoid-v3',
            'max_step': 1000,
            'state_dim': 376,
            'action_dim': 17,
            'if_discrete': False,
            'target_return': 3000.,
        }
        args = Arguments(agent, env_func=env_func, env_args=env_args)

        args.eval_times = 2 ** 2
        args.reward_scale = 2 ** -4
        args.max_memo = 2 ** 21
        args.learning_rate = 2 ** -14
        args.coeff_a_log_std = 2 ** -6

        args.target_step = args.max_step
        args.worker_num = 4

        args.net_dim = 2 ** 8
        args.layer_num = 4
        args.batch_size = args.net_dim
        args.repeat_times = 2 ** 1
        args.gamma = 0.99
        args.if_act_target = False  # todo
        import numpy as np
        args.target_entropy = np.log(env_args['action_dim'])  # todo

        args.if_allow_break = False
        args.break_step = int(2e6)
    elif env_name == 'Humanoid-v3.backup':
        from elegantrl.envs.CustomGymEnv import HumanoidEnv
        env_func = HumanoidEnv
        env_args = {
            'env_num': 1,
            'env_name': 'Humanoid-v3',
            'max_step': 1000,
            'state_dim': 376,
            'action_dim': 17,
            'if_discrete': False,
            'target_return': 3000.,
        }
        args = Arguments(agent, env_func=env_func, env_args=env_args)

        args.eval_times = 2 ** 2
        args.reward_scale = 2 ** -4
        args.max_memo = 2 ** 21
        args.learning_rate = 2 ** -14
        args.coeff_a_log_std = 2 ** -6

        args.target_step = args.max_step
        args.worker_num = 4

        args.net_dim = 2 ** 8
        args.layer_num = 4
        args.batch_size = args.net_dim
        args.repeat_times = 2 ** 1
        args.gamma = 0.99

        args.if_allow_break = False
        args.break_step = int(2e6)

        """
        | Arguments Remove cwd: ./Humanoid-v3_ReliableSAC_2
        ################################################################################
        ID     Step    maxR |    avgR   stdR   avgS  stdS |    expR   objC   etc.
        2  8.07e+03   76.16 |
        2  8.07e+03   76.16 |   76.16    0.1     16     0 |    0.30   0.55  -0.11   0.00
        2  8.47e+04  226.51 |
        2  8.47e+04  226.51 |  226.51   12.0     45     2 |    0.29   0.03   4.31   0.00
        2  1.26e+05  330.59 |
        2  1.26e+05  330.59 |  330.59   12.2     70     2 |    0.29   0.07   8.89   0.00
        2  1.59e+05  502.37 |
        2  1.59e+05  502.37 |  502.37   74.8    102    13 |    0.33   0.08  10.22   0.00
        2  1.89e+05  502.37 |  271.74    0.0     51     0 |    0.32   0.13  13.05   0.00
        2  2.13e+05  502.37 |  263.78    0.0     58     0 |    0.32   0.16  12.73   0.01
        2  2.34e+05  502.37 |  333.15    0.0     65     0 |    0.28   0.15  13.12   0.01
        2  2.55e+05  502.37 |  480.34   70.0    105    13 |    0.32   0.13  11.47   0.02
        2  2.76e+05  538.58 |
        2  2.76e+05  538.58 |  538.58  108.7    108    19 |    0.31   0.11  12.34   0.02
        2  2.92e+05  538.58 |  357.07    0.0     68     0 |    0.30   0.12  12.55   0.02
        2  3.09e+05  538.58 |  401.06    0.0     79     0 |    0.30   0.12  12.48   0.02
        2  3.26e+05  538.58 |  359.38    0.0     78     0 |    0.31   0.13  14.05   0.02
        2  3.43e+05  538.58 |  415.86    0.0     98     0 |    0.30   0.14  14.95   0.02
        2  3.59e+05  538.58 |  427.16    0.0     80     0 |    0.31   0.15  14.31   0.02
        2  3.77e+05  538.58 |  486.99    0.0     93     0 |    0.30   0.16  14.94   0.02
        2  3.89e+05  538.58 |  462.94    0.0    101     0 |    0.30   0.17  15.75   0.02
        2  4.01e+05  538.58 |  419.89    0.0     99     0 |    0.30   0.18  15.39   0.02
        2  4.14e+05  538.58 |  479.96    0.0     90     0 |    0.31   0.19  15.36   0.02
        2  4.27e+05  538.58 |  537.61    0.0    119     0 |    0.30   0.20  15.81   0.02
        2  4.39e+05  538.58 |  363.96    0.0     75     0 |    0.30   0.21  15.95   0.02
        2  4.52e+05  538.58 |  535.53  158.0    110    35 |    0.30   0.21  17.68   0.02
        2  4.65e+05  538.58 |  434.56    0.0     90     0 |    0.31   0.22  17.65   0.02
        2  4.78e+05  538.58 |  421.31    0.0     88     0 |    0.31   0.22  16.96   0.02
        2  4.91e+05  538.58 |  372.28    0.0     74     0 |    0.30   0.23  17.25   0.02
        2  5.03e+05  538.58 |  455.47  128.7     96    29 |    0.30   0.23  18.11   0.02
        2  5.16e+05  538.58 |  428.26    0.0     86     0 |    0.31   0.24  18.75   0.02
        2  5.29e+05  538.58 |  316.51    0.0     62     0 |    0.31   0.24  19.18   0.02
        2  5.42e+05  615.80 |
        2  5.42e+05  615.80 |  615.80   96.7    123    21 |    0.31   0.25  21.45   0.02
        2  5.54e+05  826.89 |
        2  5.54e+05  826.89 |  826.89  104.2    168    26 |    0.30   0.27  20.43   0.02
        2  5.67e+05  826.89 |  450.51    0.0     92     0 |    0.31   0.27  19.76   0.02
        2  5.80e+05  826.89 |  498.25    0.0     92     0 |    0.31   0.27  21.87   0.02
        2  5.93e+05  826.89 |  815.60  147.8    166    33 |    0.31   0.27  22.05   0.02
        2  6.02e+05  826.89 |  699.31    0.0    147     0 |    0.30   0.28  22.44   0.02
        2  6.10e+05  826.89 |  643.56    0.0    126     0 |    0.31   0.28  23.44   0.02
        2  6.19e+05  826.89 |  167.29    0.0     33     0 |    0.31   0.28  23.14   0.02
        2  6.28e+05  826.89 |  367.48    0.0     74     0 |    0.31   0.29  23.11   0.02
        2  6.36e+05  826.89 |  658.05    0.0    127     0 |    0.31   0.29  22.56   0.02
        2  6.45e+05  826.89 |  746.85    0.0    147     0 |    0.31   0.29  23.29   0.02
        2  6.54e+05  826.89 |  767.08    0.0    168     0 |    0.30   0.29  21.61   0.02
        2  6.62e+05  826.89 |  736.44    0.0    139     0 |    0.30   0.30  23.38   0.02
        2  6.71e+05  826.89 |  436.42    0.0     94     0 |    0.30   0.30  22.17   0.02
        2  6.80e+05  826.89 |  634.87    0.0    120     0 |    0.30   0.29  24.19   0.02
        2  6.89e+05  826.89 |  595.90  189.0    123    44 |    0.31   0.29  26.35   0.02
        2  6.97e+05  826.89 |  567.10    0.0    107     0 |    0.31   0.31  24.67   0.02
        2  7.06e+05  826.89 |  595.54    0.0    114     0 |    0.31   0.31  24.35   0.02
        2  7.15e+05  826.89 |  399.45    0.0     77     0 |    0.31   0.30  23.58   0.02
        2  7.23e+05  826.89 |  434.58    0.0     85     0 |    0.31   0.31  25.30   0.02
        2  7.32e+05  826.89 |  446.36    0.0     83     0 |    0.31   0.31  26.40   0.02
        2  7.40e+05  826.89 |  537.46    0.0     97     0 |    0.31   0.31  24.95   0.02
        2  7.49e+05  826.89 |  671.12    0.0    137     0 |    0.32   0.30  24.95   0.02
        2  7.58e+05  826.89 |  453.14    0.0     87     0 |    0.31   0.31  25.86   0.02
        2  7.67e+05  826.89 |  691.16    0.0    130     0 |    0.31   0.30  25.07   0.02
        2  7.75e+05 1530.83 |
        2  7.75e+05 1530.83 | 1530.83  396.3    297    80 |    0.30   0.31  23.88   0.02
        2  7.84e+05 1530.83 |  891.09    0.0    180     0 |    0.31   0.30  25.45   0.02
        2  7.93e+05 1530.83 |  360.46    0.0     70     0 |    0.31   0.31  26.00   0.02
        2  8.01e+05 1530.83 |  452.85    0.0     90     0 |    0.30   0.30  24.52   0.02
        2  8.10e+05 1530.83 |  663.09    0.0    131     0 |    0.32   0.30  26.27   0.02
        2  8.19e+05 1530.83 | 1212.53  511.4    247   106 |    0.31   0.30  26.67   0.02
        2  8.28e+05 1530.83 |  799.14    0.0    151     0 |    0.31   0.30  23.82   0.02
        2  8.37e+05 1530.83 |  779.43    0.0    156     0 |    0.31   0.30  25.61   0.02
        2  8.45e+05 1530.83 |  631.44    0.0    118     0 |    0.31   0.30  25.03   0.02
        2  8.54e+05 1530.83 | 1248.43    0.0    248     0 |    0.31   0.30  25.75   0.02
        2  8.63e+05 1530.83 |  928.86    0.0    182     0 |    0.31   0.30  26.13   0.02
        2  8.73e+05 1530.83 | 1125.56    0.0    219     0 |    0.31   0.30  26.08   0.02
        2  8.82e+05 1530.83 |  698.18    0.0    145     0 |    0.31   0.30  26.49   0.02
        2  8.91e+05 1530.83 |  961.80    0.0    212     0 |    0.30   0.30  26.33   0.02
        2  9.00e+05 1530.83 | 1174.05    0.0    230     0 |    0.31   0.30  26.08   0.02
        2  9.09e+05 1530.83 | 1100.58    0.0    239     0 |    0.31   0.30  27.55   0.02
        2  9.18e+05 1868.20 |
        2  9.18e+05 1868.20 | 1868.20  164.8    371    30 |    0.30   0.30  26.45   0.02
        2  9.28e+05 1868.20 | 1073.36    0.0    201     0 |    0.31   0.30  26.89   0.02
        2  9.37e+05 1868.20 | 1205.66    0.0    230     0 |    0.31   0.30  26.77   0.02
        2  9.46e+05 1868.20 | 1372.51    0.0    267     0 |    0.31   0.29  28.57   0.02
        2  9.56e+05 1868.20 |  798.34    0.0    154     0 |    0.31   0.30  28.85   0.02
        2  9.66e+05 1868.20 | 1428.51  788.3    277   150 |    0.32   0.29  27.15   0.02
        2  9.75e+05 1868.20 |  608.42    0.0    116     0 |    0.31   0.28  29.42   0.02
        2  9.85e+05 1868.20 |  325.33    0.0     64     0 |    0.31   0.29  28.10   0.02
        2  9.95e+05 1928.41 |
        2  9.95e+05 1928.41 | 1928.41  822.3    379   159 |    0.32   0.29  29.61   0.02
        2  1.00e+06 1928.41 | 1149.56    0.0    226     0 |    0.31   0.29  28.76   0.02
        2  1.01e+06 1928.41 | 1721.60    0.0    345     0 |    0.31   0.28  28.38   0.02
        2  1.02e+06 1928.41 | 1185.92    0.0    223     0 |    0.32   0.29  27.91   0.02
        2  1.03e+06 1928.41 | 1233.72    0.0    244     0 |    0.31   0.28  28.91   0.02
        2  1.04e+06 1928.41 | 1551.67    0.0    303     0 |    0.31   0.28  29.68   0.02
        2  1.05e+06 1928.41 |  978.83    0.0    192     0 |    0.31   0.28  28.76   0.02
        2  1.06e+06 2257.10 |
        2  1.06e+06 2257.10 | 2257.10  674.7    421   120 |    0.31   0.28  29.41   0.02
        2  1.07e+06 2257.10 | 2150.05    0.0    401     0 |    0.32   0.28  29.53   0.02
        2  1.08e+06 2257.10 |  775.42    0.0    149     0 |    0.31   0.28  29.71   0.02
        2  1.09e+06 2257.10 |  681.05    0.0    134     0 |    0.31   0.28  29.51   0.02
        2  1.10e+06 2257.10 | 1053.45    0.0    209     0 |    0.31   0.28  28.97   0.02
        2  1.11e+06 2257.10 |  850.63    0.0    170     0 |    0.31   0.27  29.28   0.02
        2  1.12e+06 2257.10 | 1736.51    0.0    344     0 |    0.31   0.28  30.47   0.02
        2  1.13e+06 2257.10 | 1936.67    0.0    370     0 |    0.32   0.27  29.64   0.02
        2  1.14e+06 2257.10 | 2247.72 1388.4    426   262 |    0.31   0.26  30.76   0.02
        2  1.15e+06 2825.53 |
        2  1.15e+06 2825.53 | 2825.53 1191.8    556   232 |    0.32   0.26  30.33   0.02
        2  1.16e+06 2825.53 | 2546.58 1666.1    498   332 |    0.32   0.27  30.56   0.02
        2  1.17e+06 2825.53 |  850.81    0.0    166     0 |    0.32   0.26  29.23   0.01
        2  1.18e+06 2825.53 | 1411.25    0.0    280     0 |    0.32   0.26  28.02   0.01
        2  1.19e+06 2825.53 |  538.52    0.0    109     0 |    0.32   0.26  31.44   0.01
        2  1.19e+06 2825.53 | 2693.81    0.0    508     0 |    0.31   0.26  30.05   0.01
        2  1.20e+06 2978.43 |
        2  1.20e+06 2978.43 | 2978.43 1663.4    573   317 |    0.32   0.25  30.95   0.01
        2  1.20e+06 3575.62 |
        2  1.20e+06 3575.62 | 3575.62 1612.5    694   314 |    0.31   0.26  31.57   0.01
        2  1.21e+06 3575.62 |  993.93    0.0    186     0 |    0.32   0.25  29.87   0.01
        2  1.21e+06 3575.62 | 1999.92    0.0    392     0 |    0.31   0.26  30.52   0.01
        2  1.22e+06 3575.62 |  889.42    0.0    171     0 |    0.33   0.25  30.81   0.01
        2  1.22e+06 3575.62 | 3405.88 1731.5    668   338 |    0.32   0.25  31.85   0.01
        2  1.23e+06 3575.62 |  892.11    0.0    168     0 |    0.32   0.25  31.85   0.01
        2  1.23e+06 3575.62 |  778.46    0.0    147     0 |    0.32   0.25  31.28   0.01
        2  1.24e+06 3575.62 | 1535.40    0.0    310     0 |    0.32   0.25  31.43   0.01
        2  1.24e+06 3575.62 | 2843.25 1210.4    554   243 |    0.32   0.25  29.70   0.01
        2  1.25e+06 3575.62 | 3353.49    0.0    631     0 |    0.31   0.25  30.64   0.01
        2  1.25e+06 3575.62 |  883.32    0.0    170     0 |    0.32   0.25  31.49   0.01
        2  1.26e+06 3575.62 | 3092.77 1210.6    606   226 |    0.32   0.25  31.16   0.01
        2  1.26e+06 3575.62 |  569.80    0.0    112     0 |    0.32   0.24  31.06   0.01
        2  1.27e+06 3575.62 | 1041.53    0.0    197     0 |    0.31   0.24  31.33   0.01
        2  1.28e+06 3575.62 | 3255.92    0.0    638     0 |    0.33   0.24  30.84   0.01
        2  1.28e+06 3575.62 | 2279.13    0.0    434     0 |    0.33   0.24  33.50   0.01
        2  1.29e+06 3575.62 |  559.01    0.0    107     0 |    0.32   0.24  32.44   0.01
        2  1.29e+06 3575.62 | 3277.19    0.0    649     0 |    0.32   0.25  32.05   0.01
        2  1.29e+06 3575.62 | 1050.02    0.0    204     0 |    0.33   0.24  31.84   0.01
        2  1.30e+06 3575.62 |  715.11    0.0    138     0 |    0.32   0.24  32.69   0.01
        2  1.31e+06 3575.62 |  569.46    0.0    111     0 |    0.32   0.24  31.83   0.01
        2  1.31e+06 3575.62 |  948.73    0.0    180     0 |    0.33   0.25  32.41   0.01
        2  1.31e+06 3575.62 | 1140.72    0.0    224     0 |    0.33   0.24  30.14   0.01
        2  1.32e+06 3575.62 | 1303.37    0.0    249     0 |    0.32   0.24  30.97   0.01
        2  1.32e+06 3575.62 | 2585.92    0.0    511     0 |    0.33   0.24  30.48   0.01
        2  1.33e+06 4376.07 |
        2  1.33e+06 4376.07 | 4376.07 1031.6    854   199 |    0.33   0.24  31.88   0.01
        2  1.34e+06 4376.07 | 2329.53    0.0    447     0 |    0.32   0.24  31.45   0.01
        2  1.34e+06 4376.07 | 2766.31 1240.2    565   254 |    0.32   0.24  32.76   0.01
        2  1.35e+06 4376.07 | 3559.24    0.0    672     0 |    0.32   0.24  32.08   0.01
        2  1.35e+06 4376.07 | 2982.04 1761.5    557   330 |    0.31   0.24  31.67   0.01
        2  1.36e+06 4376.07 | 1431.25    0.0    282     0 |    0.32   0.23  31.13   0.01
        2  1.36e+06 4376.07 | 1818.30    0.0    373     0 |    0.32   0.24  30.68   0.01
        2  1.37e+06 4376.07 |  911.64    0.0    167     0 |    0.33   0.24  31.94   0.01
        2  1.37e+06 4376.07 | 2429.27    0.0    442     0 |    0.32   0.24  31.20   0.01
        2  1.38e+06 4376.07 | 1491.57    0.0    294     0 |    0.33   0.23  31.37   0.01
        2  1.38e+06 4376.07 | 1535.84    0.0    294     0 |    0.33   0.22  32.09   0.01
        2  1.39e+06 4376.07 | 1724.81    0.0    331     0 |    0.33   0.24  31.07   0.01
        2  1.39e+06 4376.07 | 1426.36    0.0    273     0 |    0.33   0.23  32.00   0.01
        2  1.40e+06 4376.07 | 2066.45 1369.6    401   264 |    0.33   0.23  33.17   0.01
        2  1.40e+06 4376.07 | 1078.23    0.0    210     0 |    0.33   0.23  31.05   0.01
        2  1.41e+06 4376.07 | 1217.95    0.0    256     0 |    0.33   0.23  32.79   0.01
        2  1.41e+06 4376.07 | 1394.94    0.0    270     0 |    0.33   0.23  33.30   0.01
        2  1.42e+06 4376.07 | 3662.75    0.0    688     0 |    0.33   0.23  34.01   0.01
        2  1.42e+06 4376.07 | 3106.36    0.0    595     0 |    0.32   0.23  32.38   0.01
        2  1.43e+06 4376.07 | 3703.49    0.0    705     0 |    0.33   0.23  33.98   0.01
        2  1.43e+06 4376.07 | 1284.99    0.0    240     0 |    0.33   0.22  33.41   0.01
        2  1.44e+06 4376.07 | 2499.82    0.0    479     0 |    0.33   0.23  31.52   0.01
        2  1.44e+06 4376.07 | 4095.95 1608.4    780   308 |    0.33   0.22  31.57   0.01
        2  1.45e+06 4376.07 | 1376.74    0.0    268     0 |    0.33   0.22  34.45   0.01
        2  1.45e+06 4376.07 | 1529.86    0.0    293     0 |    0.33   0.23  33.78   0.01
        2  1.46e+06 4376.07 | 2346.18    0.0    472     0 |    0.33   0.23  33.08   0.01
        2  1.46e+06 4376.07 | 1454.02    0.0    278     0 |    0.33   0.22  31.71   0.01
        2  1.47e+06 4376.07 | 4071.25    0.0    775     0 |    0.32   0.22  32.64   0.01
        2  1.47e+06 4376.07 | 4041.26 1121.8    774   226 |    0.33   0.23  32.98   0.01
        2  1.48e+06 4376.07 | 2339.81    0.0    470     0 |    0.33   0.23  34.03   0.01
        2  1.48e+06 4376.07 | 3188.20 1323.7    610   249 |    0.33   0.22  31.73   0.01
        2  1.49e+06 4376.07 | 1301.07    0.0    270     0 |    0.33   0.22  33.16   0.01
        2  1.49e+06 4376.07 | 2600.90 1531.0    535   298 |    0.33   0.22  32.24   0.01
        2  1.50e+06 4376.07 | 2169.64    0.0    433     0 |    0.32   0.22  32.96   0.01
        2  1.51e+06 4376.07 | 1137.47    0.0    221     0 |    0.33   0.22  34.14   0.01
        2  1.51e+06 4376.07 | 3703.59 1616.3    704   305 |    0.33   0.22  32.40   0.01
        2  1.52e+06 4376.07 | 2139.60    0.0    406     0 |    0.33   0.21  32.47   0.01
        2  1.52e+06 4376.07 | 4352.19 1187.4    811   229 |    0.34   0.22  33.02   0.01
        2  1.53e+06 4376.07 | 2650.12 1653.3    486   297 |    0.33   0.22  33.92   0.01
        2  1.53e+06 4376.07 | 1533.19    0.0    303     0 |    0.34   0.21  31.45   0.01
        2  1.54e+06 4376.07 |  780.99    0.0    146     0 |    0.33   0.21  32.48   0.01
        2  1.54e+06 4376.07 | 2626.05    0.0    509     0 |    0.33   0.21  33.91   0.01
        2  1.55e+06 4376.07 | 4370.40    0.0    823     0 |    0.33   0.21  31.92   0.01
        2  1.55e+06 4376.07 | 1506.31    0.0    297     0 |    0.33   0.22  33.49   0.01
        2  1.56e+06 4376.07 | 2899.16 1496.5    554   282 |    0.33   0.21  32.71   0.01
        2  1.56e+06 4376.07 | 1198.79    0.0    236     0 |    0.34   0.20  34.19   0.01
        2  1.57e+06 4376.07 | 4314.28 1905.6    795   350 |    0.33   0.21  32.53   0.01
        2  1.57e+06 4376.07 |  932.14    0.0    185     0 |    0.33   0.20  32.61   0.01
        2  1.58e+06 4376.07 | 3710.02    0.0    680     0 |    0.33   0.21  33.56   0.01
        2  1.58e+06 4376.07 | 1788.02    0.0    334     0 |    0.33   0.20  32.80   0.01
        2  1.59e+06 4376.07 | 2178.98    0.0    405     0 |    0.33   0.20  35.01   0.01
        2  1.59e+06 4661.43 |
        2  1.59e+06 4661.43 | 4661.43 1205.4    870   225 |    0.33   0.21  34.16   0.01
        2  1.60e+06 4661.43 | 4636.75 1363.6    856   249 |    0.34   0.20  32.75   0.01
        2  1.60e+06 4661.43 | 3285.64    0.0    641     0 |    0.34   0.20  34.36   0.01
        2  1.61e+06 4661.43 | 3996.92    0.0    746     0 |    0.33   0.20  32.96   0.01
        2  1.61e+06 4808.85 |
        2  1.61e+06 4808.85 | 4808.85  858.2    905   165 |    0.32   0.20  32.36   0.01
        2  1.62e+06 4808.85 | 3711.65 1420.6    712   269 |    0.33   0.20  33.59   0.01
        2  1.62e+06 4808.85 | 2343.89    0.0    433     0 |    0.32   0.20  33.83   0.01
        2  1.63e+06 4808.85 | 3650.32 1767.0    675   326 |    0.33   0.19  33.05   0.01
        2  1.64e+06 4808.85 | 1539.43    0.0    279     0 |    0.33   0.19  34.10   0.01
        2  1.64e+06 4808.85 | 3677.19 1948.3    664   352 |    0.34   0.19  34.59   0.01
        2  1.65e+06 4808.85 | 2687.31    0.0    496     0 |    0.33   0.20  33.47   0.01
        2  1.65e+06 4808.85 | 1542.33    0.0    290     0 |    0.33   0.19  33.24   0.01
        2  1.66e+06 4808.85 |  867.88    0.0    173     0 |    0.34   0.19  34.27   0.01
        2  1.66e+06 4808.85 | 3085.34 1711.3    579   322 |    0.34   0.20  33.70   0.01
        2  1.67e+06 4808.85 | 1687.58    0.0    323     0 |    0.33   0.20  34.93   0.01
        2  1.67e+06 4808.85 | 4066.38 1268.1    742   228 |    0.34   0.19  32.41   0.01
        2  1.68e+06 4808.85 |  452.65    0.0     91     0 |    0.33   0.20  33.70   0.01
        2  1.68e+06 4808.85 | 3018.52    0.0    558     0 |    0.34   0.21  34.58   0.01
        2  1.69e+06 4808.85 |  430.01    0.0    102     0 |    0.33   0.35  38.89   0.02
        2  1.69e+06 4808.85 |  472.74    0.0    109     0 |    0.33   0.40  44.93   0.03
        2  1.70e+06 4808.85 |  628.25    0.0    136     0 |    0.31   0.32  44.62   0.02
        2  1.70e+06 4808.85 |  812.73    0.0    167     0 |    0.28   0.27  42.12   0.01
        2  1.70e+06 4808.85 | 1707.97    0.0    327     0 |    0.31   0.24  39.53   0.01
        2  1.71e+06 4808.85 | 1819.14    0.0    339     0 |    0.32   0.23  36.88   0.01
        2  1.72e+06 4808.85 | 2053.70    0.0    388     0 |    0.33   0.21  35.72   0.01
        2  1.72e+06 4808.85 | 2262.07    0.0    419     0 |    0.33   0.21  33.69   0.01
        2  1.72e+06 4808.85 |  787.00    0.0    153     0 |    0.33   0.20  35.14   0.01
        2  1.73e+06 4808.85 | 1620.02    0.0    309     0 |    0.34   0.20  33.92   0.01
        2  1.74e+06 4808.85 | 2368.23    0.0    447     0 |    0.33   0.20  34.85   0.01
        2  1.74e+06 4846.42 |
        2  1.74e+06 4846.42 | 4846.42  581.3    906   110 |    0.33   0.19  34.40   0.01
        2  1.75e+06 4846.42 |  752.17    0.0    150     0 |    0.34   0.19  33.20   0.01
        2  1.75e+06 4846.42 | 3085.69 2158.1    576   395 |    0.34   0.19  34.28   0.01
        2  1.76e+06 4846.42 |  381.14    0.0     71     0 |    0.34   0.20  33.92   0.01
        2  1.76e+06 4846.42 | 3684.18    0.0    693     0 |    0.34   0.19  34.47   0.01
        2  1.77e+06 5436.18 |
        2  1.77e+06 5436.18 | 5436.18   35.3   1000     0 |    0.33   0.19  34.15   0.01
        2  1.77e+06 5436.18 | 5327.19    0.0   1000     0 |    0.34   0.19  33.98   0.01
        2  1.78e+06 5436.18 | 4729.78    0.0    857     0 |    0.34   0.20  34.32   0.01
        2  1.78e+06 5578.46 |
        2  1.78e+06 5578.46 | 5578.46   86.6   1000     0 |    0.34   0.19  34.41   0.01
        2  1.79e+06 5578.46 | 2561.99    0.0    473     0 |    0.34   0.19  34.08   0.01
        2  1.79e+06 5578.46 | 5432.93    0.0   1000     0 |    0.35   0.19  34.19   0.01
        2  1.80e+06 5578.46 | 1247.43    0.0    232     0 |    0.34   0.19  34.27   0.01
        2  1.80e+06 5578.46 | 3227.15    0.0    598     0 |    0.35   0.18  35.06   0.01
        2  1.81e+06 5578.46 | 3294.27    0.0    610     0 |    0.35   0.18  34.52   0.01
        2  1.81e+06 5578.46 | 5424.16    0.0   1000     0 |    0.33   0.18  34.81   0.01
        2  1.82e+06 5578.46 | 5410.13    0.0   1000     0 |    0.34   0.18  34.04   0.01
        2  1.82e+06 5578.46 | 2406.91    0.0    454     0 |    0.34   0.18  35.67   0.01
        2  1.83e+06 5578.46 | 5494.68    0.0   1000     0 |    0.34   0.18  35.15   0.01
        2  1.83e+06 5578.46 | 2468.08    0.0    535     0 |    0.34   0.19  34.65   0.01
        2  1.84e+06 5578.46 | 3286.31    0.0    633     0 |    0.34   0.19  34.83   0.01
        2  1.84e+06 5578.46 | 5295.30    0.0   1000     0 |    0.33   0.19  33.75   0.01
        2  1.85e+06 5578.46 | 1098.72    0.0    216     0 |    0.34   0.18  35.00   0.01
        2  1.85e+06 5578.46 | 2036.09    0.0    381     0 |    0.34   0.18  34.08   0.01
        2  1.86e+06 5578.46 |  704.63    0.0    135     0 |    0.34   0.18  32.72   0.01
        2  1.86e+06 5578.46 | 5437.36    0.0   1000     0 |    0.33   0.18  35.17   0.01
        2  1.87e+06 5578.46 | 1882.41    0.0    352     0 |    0.34   0.18  33.29   0.01
        2  1.87e+06 5578.46 | 2585.14    0.0    453     0 |    0.34   0.18  34.44   0.01
        2  1.88e+06 5578.46 | 3676.13    0.0    674     0 |    0.34   0.18  33.99   0.01
        2  1.88e+06 5578.46 | 2395.74    0.0    438     0 |    0.34   0.18  34.04   0.01
        2  1.89e+06 5578.46 | 1226.04    0.0    241     0 |    0.34   0.17  34.84   0.01
        2  1.89e+06 5578.46 | 5255.36    0.0   1000     0 |    0.34   0.18  33.56   0.01
        2  1.90e+06 5578.46 | 5571.49    0.0   1000     0 |    0.35   0.17  34.05   0.01
        2  1.90e+06 5578.46 | 3593.36    0.0    716     0 |    0.34   0.18  33.59   0.01
        2  1.91e+06 5578.46 | 5293.41    0.0   1000     0 |    0.35   0.18  34.38   0.01
        2  1.91e+06 5578.46 | 4169.86    0.0    795     0 |    0.33   0.18  34.22   0.01
        2  1.92e+06 5578.46 | 3631.33    0.0    647     0 |    0.34   0.17  34.96   0.01
        2  1.92e+06 5578.46 | 5460.01    0.0   1000     0 |    0.35   0.17  34.32   0.01
        2  1.93e+06 5578.46 | 5410.56    0.0   1000     0 |    0.35   0.17  33.34   0.01
        2  1.93e+06 5578.46 | 5460.13    0.0   1000     0 |    0.34   0.17  33.90   0.01
        2  1.94e+06 5578.46 | 2817.41    0.0    537     0 |    0.34   0.18  34.36   0.01
        2  1.94e+06 5578.46 | 1858.92    0.0    339     0 |    0.35   0.17  34.96   0.01
        2  1.95e+06 5578.46 | 2207.20    0.0    418     0 |    0.34   0.17  35.02   0.01
        2  1.95e+06 5578.46 | 2759.04    0.0    523     0 |    0.35   0.17  35.04   0.01
        2  1.96e+06 5578.46 | 5266.78    0.0    940     0 |    0.35   0.17  33.96   0.01
        2  1.96e+06 5578.46 | 1092.09    0.0    203     0 |    0.34   0.18  33.64   0.01
        2  1.97e+06 5578.46 | 2487.55    0.0    446     0 |    0.34   0.26  37.81   0.02
        2  1.97e+06 5578.46 | 2313.96    0.0    420     0 |    0.34   0.23  40.44   0.01
        2  1.98e+06 5606.16 |
        2  1.98e+06 5606.16 | 5606.16   51.8   1000     0 |    0.32   0.21  38.85   0.01
        2  1.98e+06 5606.16 | 3925.41    0.0    696     0 |    0.34   0.19  37.93   0.01
        2  1.99e+06 5606.16 | 5475.95    0.0   1000     0 |    0.35   0.18  35.79   0.01
        2  1.99e+06 5606.16 | 2794.34    0.0    516     0 |    0.36   0.19  34.80   0.01
        2  2.00e+06 5606.16 | 5602.57    0.0   1000     0 |    0.35   0.17  34.41   0.01
        2  2.00e+06 5606.16 | 5382.77  326.0    968    56 |    0.35   0.18  35.26   0.01
        | UsedTime:   45183 | SavedDir: ./Humanoid-v3_ReliableSAC_2
        | Learner: Save in ./Humanoid-v3_ReliableSAC_2
        """
    else:
        raise ValueError('env_name:', env_name)

    args.learner_gpus = gpu_id
    args.random_seed += gpu_id

    if_check = 0
    if if_check:
        train_and_evaluate(args)
    else:
        train_and_evaluate_mp(args)


if __name__ == '__main__':
    GPU_ID = int(sys.argv[1]) if len(sys.argv) > 1 else 0  # >=0 means GPU ID, -1 means CPU
    DRL_ID = int(sys.argv[2]) if len(sys.argv) > 2 else 3
    ENV_ID = int(sys.argv[3]) if len(sys.argv) > 3 else 1

    demo_ddpg_td3_sac(GPU_ID, DRL_ID, ENV_ID)
